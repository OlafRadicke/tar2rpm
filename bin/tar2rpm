#!/usr/bin/env ruby -wKU

require 'optparse'

summary = ''
description = ''
architecture = 'noarch'
filename = nil

OptionParser.new do |opts|
  opts.banner = "Usage: tar2rpm [ options ] tarfile"

  opts.on("-s", "--summary msg", String, "Package Summary") do |sum|
    summary = sum
  end

  opts.on("-d", "--descr msg", String, "Package Description") do |desc|
    description = desc
  end

  opts.on("-a", "--arch val", String, "Architecture (noarch, x86_64, i386)") do |arch|
    architecture = arch
  end

  opts.on("-h", "--help", "Show this message") do
    puts opts
    exit
  end

  begin
    ARGV << "-h" if ARGV.empty?
    opts.parse!(ARGV)

    if ARGV.empty?
      STDERR.puts "Must have at least one file\n\n", opts
      exit(-1)
    end

    filename = ARGV.pop

    unless ARGV.empty?
      STDERR.puts "Can only handle one file\n\n", opts
      exit(-1)
    end
  rescue OptionParser::ParseError => e
    STDERR.puts e.message, "\n", opts
    exit(-1)
  end
end

puts "summary #{summary}"
puts "desc #{description}"
puts "architecture #{architecture}"
puts "filename #{filename}"
